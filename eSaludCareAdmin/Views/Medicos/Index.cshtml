@model List<CapaEntidad.MedicoDTO>

@{
    var nombreActual = Request.QueryString["nombre"];
    var especialidadActual = Request.QueryString["especialidad"];
    var hayFiltros = !string.IsNullOrEmpty(nombreActual) || !string.IsNullOrEmpty(especialidadActual);
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
    h2 {
        color: #007b7f;
        font-weight: 700;
        margin-bottom: 25px;
        font-size: 1.8rem;
    }

    .table thead th {
        background-color: #007b7f;
        color: white;
        font-weight: 500;
        text-transform: uppercase;
        font-size: 0.8rem;
        border: none !important;
        padding: 12px 15px;
        letter-spacing: 0.5px;
        vertical-align: middle;
    }

    .table tbody tr td {
        padding: 12px 15px;
        font-size: 0.95rem;
        vertical-align: middle;
        border-color: #e9ecef;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f8f8f8;
    }
</style>

<h2>Listado de Médicos Registrados</h2>

<!-- 🔍 Buscador de médicos -->
<form method="get" action="@Url.Action("Index", "Medicos")" class="mb-4">
    <div class="row g-3 align-items-end">
        <div class="col-md-4">
            <label for="nombre" class="form-label">Nombre</label>
            <div class="input-group">
                <span class="input-group-text"><i class="bi bi-person"></i></span>
                <input type="text" name="nombre" id="nombre" class="form-control" placeholder="Buscar por nombre" value="@nombreActual" />
            </div>
        </div>
        <div class="col-md-4">
            <label for="especialidad" class="form-label">Especialidad</label>
            <div class="input-group">
                <span class="input-group-text"><i class="bi bi-briefcase-medical"></i></span>
                <input type="text" name="especialidad" id="especialidad" class="form-control" placeholder="Buscar por especialidad" value="@especialidadActual" />
            </div>
        </div>
        <div class="col-md-4 d-flex gap-2">
            <button type="submit" class="btn btn-primary"><i class="bi bi-search"></i> Buscar</button>
            @if (hayFiltros)
            {
                <a href="@Url.Action("Index", "Medicos")" class="btn btn-outline-secondary"><i class="bi bi-x-circle"></i> Limpiar filtros</a>
            }
        </div>
    </div>
</form>

@if (ViewBag.Error != null)
{
    <div class="alert alert-danger">@ViewBag.Error</div>
}
else
{
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Nombre Completo</th>
                <th>Correo</th>
                <th>Teléfono</th>
                <th>Especialidad</th>
                <th>Cédula</th>
                <th>Fecha de Registro</th>
                <th>Última Actualización</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var medico in Model)
            {
                <tr>
                    <td>@medico.Nombre @medico.Apellido</td>
                    <td>@medico.Correo</td>
                    <td>@medico.Telefono</td>
                    <td>@medico.Especialidad</td>
                    <td>@medico.NumeroCedula</td>
                    <td>@medico.FechaRegistro.ToString("dd/MM/yyyy")</td>
                    <td>@medico.FechaActualizacion.ToString("dd/MM/yyyy")</td>
                </tr>
            }
        </tbody>
    </table>
}